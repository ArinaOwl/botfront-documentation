---
name: Using slots
route: /docs/rasa/slots/
menu: Authoring conversations
meta:
    - name: description
      content: The conversation builder is the most intuitive frontent UI for Rasa.
    - name: keywords
      content: rasa ui frontend
---

# Extracting entites


Entities are elements you want to extract from a user utterance.

## Trainable entities

In most cases you need to tag entities in user utterances so your model learns how to find them.

In the example below, a user wants to buy a shirt and want to specify a color:

<video autoplay muted loop width='100%' controls>
    <source
        src='../../../videos/conversation_quickstart9.m4v'
        type='video/mp4'
    />
    Your browser does not support the video tag.
</video>

Even if you know the intent, you might want to take the order attributes in consideration when answering to or dealing with a user request.
These attributes can be modeled as entities.

To boost the accuracy of your assistant, you want to add several examples of utterances with that entities.

<video autoplay muted loop width='100%' controls>
    <source
        src='../../../videos/conversation_quickstart10.m4v'
        type='video/mp4'
    />
    Your browser does not support the video tag.
</video>

The goal here is to give examples with enough variety so you model can learn to generalize to utterances not in your training data.
In other words, you want to add enough data so your assistant starts to understand sentences it has never seen before.

For intents, it is about using a variety of words, and not just repeating the same sentence with a color variation.

For entities, it is about teaching your assistant how to retrieve it in different sentences. From your examples, your model should understand:

-   The content of your entities: give several colors (not necessarily all possible colors but enough to observe that it starts picking up colors it hasn't seen before)
-   The words before and after the entity.

> Keep in mind that the entity is not tied to an intent. You might use the same **color** entity with another intent.

## Extracting number, dates and other structured entities

Botfront integrates Rasa, which integrates [Duckling](https://github.com/facebook/duckling), an open source structured entity extractor developed by Facebook.
You must enable it in your NLU pipeline.
Here is an example of duckling configuration:

### Duckling extractor configuration

```yaml
- name: DucklingHTTPExtractor
  # Specify a URL if using Botfront open source or enterprise edition.
  # Botfront Cloud users must not specify a URL
  # url: http://duckling:8000
  locale: en_US
  dimensions:
    - number
    - date
    - amount-of-money
```

You need to set this configuration in your NLU pipeline, as shown in the following video:

<video autoplay muted loop width='100%' controls>
    <source
        src='../../../videos/conversation_quickstart14.m4v'
        type='video/mp4'
    />
    Your browser does not support the video tag.
</video>

<Important type="danger" title="Indentation errors can result in failures">
    Make sure to check the indentation before saving.
</Important>

A few things to keep in mind:

- **Botfront Cloud users do not need to specify an url.**
- You need to specify the locale
- You need to add a Duckling configuration to the NLU pipeline in all languages.
- You need to specify the entities you want to extract with the `dimensions` parameter. In the example above, only numbers, time/dates and amounts of money will be extracted.

The following table lists the structured entities available with Duckling.

| Dimension            | Example input         | Example value output                                                                                                                                         |
| -------------------- | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `amount-of-money`    | "42â‚¬"                 | `{"value":42,"type":"value","unit":"EUR"}`                                                                                                                   |
| `credit-card-number` | "4111-1111-1111-1111" | `{"value":"4111111111111111","issuer":"visa"}`                                                                                                               |
| `distance`           | "6 miles"             | `{"value":6,"type":"value","unit":"mile"}`                                                                                                                   |
| `duration`           | "3 mins"              | `{"value":3,"minute":3,"unit":"minute","normalized":{"value":180,"unit":"second"}}`                                                                          |
| `email`              | "hi@botfront.io"      | `{"value":"hi@botfront.io"}`                                                                                                                                 |
| `number`             | "eighty eight"        | `{"value":88,"type":"value"}`                                                                                                                                |
| `ordinal`            | "33rd"                | `{"value":33,"type":"value"}`                                                                                                                                |
| `phone-number`       | "+1 (650) 123-4567"   | `{"value":"(+1) 6501234567"}`                                                                                                                                |
| `quantity`           | "3 cups of sugar"     | `{"value":3,"type":"value","product":"sugar","unit":"cup"}`                                                                                                  |
| `temperature`        | "80F"                 | `{"value":80,"type":"value","unit":"fahrenheit"}`                                                                                                            |
| `time`               | "today at 9am"        | `{"values":[{"value":"2016-12-14T09:00:00.000-08:00","grain":"hour","type":"value"}],"value":"2016-12-14T09:00:00.000-08:00","grain":"hour","type":"value"}` |
| `url`                | "https://botfront.io" | `{"value":"https://botfront.io","domain":"botfront.io"}`                                                                                                     |
| `volume`             | "4 gallons"           | `{"value":4,"type":"value","unit":"gallon"}`                                                                                                                 |

<Important type="warning" title="DO NOT tag structured entities in your examples">
Structured entities do not need to be trained. Their extraction is pattern based. You do not need to tag entities in your NLU data.
</Important>



### Obtaining structured entity values from trainable entities

As we have seen above, structured entities extracted with Duckling do not need to be trained. This can be problematic. Suppose the following utterance:

- _I want to book a room for two people for 3 nights._

Using Duckling alone will extract twice the entity _number_, and you won't have any way to know
which number stands for the number of nights, and which number stands for the number of guests.

But using trainable entities won't work either because you won't have the final value of your entity
(i.e. the number `2` and not the string `two`)

You can fix that problem by adding the following component **at the end** of your pipeline. Or at least after both entity extractors.

```yaml
- name: rasa_addons.nlu.components.duckling_crf_merger.DucklingCrfMerger
  entities:
    guests: ["number"] # where 'guests' is the entity name and 'number' the duckling entity type you want to merge it with.
    nights: ["number"]

```

This will merge the content of the entities. In other words, instead of having this:

```json
{
  ...
  "entities": [
    {
      "start": 18,
      "end": 21,
      "value": "two",
      "entity": "guests",
      "confidence": 0.6886989589,
      "extractor": "CRFEntityExtractor"
    },
    {
      "start": 18,
      "end": 21,
      "text": "two",
      "value": 2,
      "confidence": 1,
      "additional_info": {
        "value": 2,
        "type": "value"
      },
      "entity": "number",
      "extractor": "DucklingHTTPExtractor"
    }
  ],
  "text": "I want a roow for two guests"
}
```

You will get this:
```json
{
  ...
  "entities": [
    {
    "start": 18,
    "end": 21,
    "value": 2,
    "entity": "guests",
    "confidence": 0.6886989589,
    "extractor": "CRFEntityExtractor",
    "additional_info": {
        "value": 2,
        "type": "value"
    }
    }
  ],
  "text": "I want a roow for two guests"
}
```

Note that you can use the API tab to explore the `JSON` response of a NLU request:

<video autoplay muted loop width='100%' controls>
    <source
        src='../../../videos/conversation_quickstart15.m4v'
        type='video/mp4'
    />
    Your browser does not support the video tag.
</video>



## Slots

Slots are a way to store information in a conversation context.

### Storing entity values in slots

In the example above, once we extract the entity **color**, we may want to keep it content to re-use it later.
To store the entity's content, we need to create a slot with the same name:

<video autoplay muted loop width='100%' controls>
    <source
        src='../../../videos/conversation_quickstart11.m4v'
        type='video/mp4'
    />
    Your browser does not support the video tag.
</video>

The slot **color** is automatically paired with the entity **color**. Which means that every time an entity **color** is found in the course of a conversation, its value will be stored in the slot **color**.

Note that we have set the **color** slot as **unfeaturized**, which means that the content of this slots will have no effect on the course of the conversation.

### Accessing slot values in responses

You can now re-use the slot value in a response by putting the slot name between curly braces, for example `{color}`:

<video autoplay muted loop width='100%' controls>
    <source
        src='../../../videos/conversation_quickstart12.m4v'
        type='video/mp4'
    />
    Your browser does not support the video tag.
</video>

### Driving the conversation with slots

In the example above we used an **unfeaturized** slot, meaning that the slot will never alter the conversation flow.

We'll see now how to change the course of a conversation with slots.

Suppo